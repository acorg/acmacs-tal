# Time-stamp: <2019-11-04 12:47:49 eu>

* Command line defines

-D whocc --> match seqdb

-D report-cumulative-output=-  write cumulative report to stdout
-D report-cumulative-output=filename  write cumulative report to filename

-D ladderize-method=max-edge-length  (number-of-leaves is default)

* Settings features

{"N": "if", "condition": {"and": ["{whocc}", {"not": "tree-has-sequences"}, {"or": ["{xxx}", {"not": "{yyy}"}]}, {"not-empty": "{virus-type}"}]}, "then": [{"N": ...}], "else": [{"N": ...}]}

* Node modifications

** hide
{"N": "nodes", "select": {"[[Select Nodes][Select Nodes]]"}, "apply": "hide"}

*** hide if cumulative edge length bigger than
{"N": "nodes", "select": {"cumulative >=": 0.01, "report": true}, "apply": "hide"} -- see [[Select Nodes][Select Nodes]]

*** hide isolated before
{"N": "nodes", "select": {"date": ["", "2017"], "report": true}, "apply": "hide"} -- see [[Select Nodes][Select Nodes]]

*** hide by regexp
{"N": "nodes", "select": {"seq_id": "/SWINE/", "report": true}, "apply": "hide"} -- see [[Select Nodes][Select Nodes]]

*** hide by aa
{"N": "nodes", "select": {"aa": "159F", "report": true}, "apply": "hide"} -- see [[Select Nodes][Select Nodes]]

** color
{"N": "nodes", "select": {"[[Select Nodes][Select Nodes]]"}, "apply": "color", "tree-label": "red", "time-series-dash": "red"}

** just report selected
{"N": "nodes", "select": {}, "apply": "report"} -- see [[Select Nodes][Select Nodes]]

* Settings

{"N": "if", "condition": {"and": ["{whocc}", {"not": "tree-has-sequences"}]}, "then": [{"N": "seqdb", "filename": "{seqdb-filename}"}]}
{"N": "seqdb", "filename": "{seqdb-filename}"}

- {"N": "clade", "subtype": "A(H3N2)"} detect clade (only if aa_sequence present) based on given criteria

{"N": "ladderize", "method": "number-of-leaves", "?method": "max-edge-length"}
{"N": "re-root", "new-root": <seq-id>}

{"N": "aa-transitions", "report": false} -- use upon hiding nodes

{"N": "nodes", "select": <select>, "apply": <node-apply>} -- See [[Node modifications][Node modifications]]

{"N": "clades-reset"}
{"N": "clade", "name": "3C.2A1B", "display_name": "2A1B", "substitutions": ["92R", "121K", "158N", "159Y", "171K", "311Q", "406V", "484E"], "report": true, "inclusion_tolerance": "{clade_section_inclusion_tolerance}", "exclusion_tolerance": "{clade_section_exclusion_tolerance}"}

** Report

{"N": "report-cumulative", "output": "{report-cumulative-output}", "all": false}
{"N": "report-time-series", "output": "{report-time-series-output}"}

* Select Nodes

If multiple criteria specified within single "select" object, they all used (conjunction)

{"all": true}
{"aa": ["192Q", "!123E"]}
{"cumulative >=": 0.01, "report": true}
{"date": ["start >=", "end <", "report": true}
{"seq_id": "regexp", "report": true}
{"vaccine": {"type": "current", "passage": "cell"}, "report": true}
{"matches-chart-antigen": true, "report": true}
{"matches-chart-serum": "name|reassortant|passage", "report": true} -- name only, name+reassortant, name+reassortant+passage_type

* COMMENT ====== local vars
:PROPERTIES:
:VISIBILITY: folded
:END:
#+STARTUP: showall indent
Local Variables:
eval: (auto-fill-mode 0)
eval: (add-hook 'before-save-hook 'time-stamp)
eval: (set (make-local-variable org-confirm-elisp-link-function) nil)
End:
